# principle

[toc]

## 总则

* 以实践工程为核心。技术是为了解决问题。不唯书是论。大问题要分解为各个小问题。最终目标是提供稳定服务，清晰代码，且要能够可持续发展。
  并总结一套工程理论。
* 数据是核心(数据也要尽量解耦合)，有数据强关联的服务，往往也应该是一个服务。无关联的服务应该要拆分为不同的服务。以数据为核心去拆分服务。
  暂时只用mongodb.mongo用json文档。相对宽列更切合业务逻辑。查询上面也更符合直觉。但是cassandra的数据建模需要针对查询建模。搞物化视图
  需要耗费更大的精力。这块，只需要在某些服务如果出现写瓶颈的时候进行替换即可。
* 要不断掌握优秀的
* 后端以k8s为框架
* 各个service之间负责新增和更新各自数据
	service之间需要共享数据的，统一通过service进行查询
	这么做的原因是因为： 如果服务直接去读取其他归属于其他服务的数据，则如果数据发生变更，都不知道会影响到哪些服务
	而通过服务名称去查询受影响的服务则会比较简单。而且可以做到服务之间去拿数据。而不是和数据库耦合在一起。
	各个服务可以随意选择自己的数据库（当前数据库混战时代，很长时间也是，还挺重要
	诸如： 用户画像服务，通讯录服务，聊天服务
	通讯录服务，会拿到用户的朋友列表。再通过朋友列表的ID去拿各个用户的具体数据
	offline first的设计需要探索一下
	本地数据和远程数据之间的同步
### 由各个服务负责管理各自数据，而不是共享数据库数据优缺点

优点：
	* 增加了一层服务概念，可以随意变更数据库不合理字段
	* 各个服务可以随意选择适合自己的数据库
	* 各个服务职责清晰，数据清晰，可以把共享数据这部分的任务放到客户端去完成
		(css和会管当初共享写db这种，绝对是灾难之源，绝不可以再发生)
		即使是共享读数据库也不好，数据库不能随意更改了,无论是字段还是选型

缺点：
	


## 技术选型

### 前后端

* graphql(apollo技术栈, federation)

### 前端

* flutter(学习react relay理论)
* bloc

### 后端

* 架构: k8s
* ingress: traefik
* 语言: go, nodejs(有用到apollo或者mongoose的使用nodejs，其他使用go)

#### 后端数据库

* 业务数据要能够满足定时备份，实时查看性能指标等（后续支持),数据运维方面肯定是cassandra更好
  但是cassandra这种宽列模式，需要针对查询建模。需要构建物化视图。增加了业务复杂度。
* 对象存储: minio
* 读多写少： mongodb(replcaset模式)
* 写多读少/读多:  cassandra
* 复杂关系：graphdb(看届时具体选型)



## cmd

kubectl config set-context --current --namespace cassandra

## 关于技术选型

* 技术永远在发展，不要指望一招鲜, 要多保持学习
* 技术要多测试实验，只有真正体验了，对比之后才能知道哪个好
* 某些已经成为行业标准的技术是最好的